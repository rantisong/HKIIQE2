# 试卷一真题导入说明

将四份试卷一真题 PDF 解析为 JSON 并导入云数据库后，会在**试卷一 → 试卷选择页 → 考试真题**列表中展示。

## 一、解析 PDF 为 JSON

在项目根目录执行（请将下面路径改为你本机的 PDF 路径）：

```bash
# 依赖
pip install pypdf

# 四份真题（按实际路径修改）
python3 scripts/parse_real_paper_pdf.py "/Users/lanyangyang/Desktop/papers/試卷一：2025年10月真题.pdf" docs/real_2025_10.json
python3 scripts/parse_real_paper_pdf.py "/Users/lanyangyang/Desktop/papers/試卷一：2025年11月真题.pdf" docs/real_2025_11.json
python3 scripts/parse_real_paper_pdf.py "/Users/lanyangyang/Desktop/papers/試卷一：2025年12月真题.pdf" docs/real_2025_12.json
python3 scripts/parse_real_paper_pdf.py "/Users/lanyangyang/Desktop/papers/試卷一：2026年2月真题.pdf" docs/real_2026_02.json
```

- 每份会生成一个 JSON 文件到 `docs/`，结构含 `paperType: "real"`、`subjectId: "01"`、`name`、`questions` 等。
- 若某份解析出 **0 题**，说明该 PDF 版式与当前解析规则不一致，可在脚本中根据实际排版调整 `parse_pdf_text` 中的题号/选项正则，或先导入解析成功的几份。

## 二、导入到云数据库

真题写入集合 **real_papers**，且带 **subjectId: "01"**，试卷一真题列表会按该字段筛选。

### 方式一：云存储 + 云函数（推荐，适合大文件）

1. 微信开发者工具 → 云开发 → 云存储。
2. 将生成的 `docs/real_2025_10.json`、`real_2025_11.json`、`real_2025_12.json`、`real_2026_02.json` 上传到云存储（如 `papers/` 目录下）。
3. 云函数 → `paper_importFromJson` → 云端测试，对**每个文件**执行一次，参数示例：

   ```json
   { "fileId": "cloud://xxx.xxx/xxx" }
   ```
   将 `fileId` 换为对应文件在云存储中的 File ID。

### 方式二：直接传 content（适合小体积 JSON）

在 `paper_importFromJson` 的测试参数中传入：

```json
{
  "content": <粘贴 real_2025_10.json 的完整内容>
}
```

对四份真题分别执行一次（每次 `content` 为对应 JSON 全文）。

## 三、数据结构要求

每条真题 JSON 需包含：

| 字段 | 说明 |
|------|------|
| paperType | 固定为 `"real"` |
| subjectId | 试卷一固定为 `"01"`，用于在「试卷一」下只展示本卷真题 |
| name | 真题名称，如 `"2025年10月真题"` |
| fullName | 如 `"保险原理及实务"` |
| title | 可选，如 `"试卷一：2025年10月真题"` |
| questionCount | 题目数量（可与 questions 长度一致） |
| durationMinutes | 考试时长（分钟），如 120 |
| questions | 题目数组，每题含 content/text、options（A/B/C/D）、correctAnswer |

题目格式与模拟题一致，参见 `docs/试卷一mock_import.json` 中单题结构。

## 四、云数据库索引（若报错再建）

若调用 `exam_getPaperList` 时提示需要索引，请在云开发控制台 → 数据库 → **real_papers** → 索引中新增：

- 字段：`subjectId`（升序）、`createdAt`（降序）
- 用于按科目查询真题列表并按时间排序。

## 五、前端展示

- 用户在**练习页**选择**试卷一**进入**试卷选择页**。
- **考试真题**列表会请求 `getPaperList(..., 'real', '01')`，只返回 `subjectId === '01'` 的真题。
- 四份导入成功后，将显示「2025年10月真题」「2025年11月真题」「2025年12月真题」「2026年2月真题」，点击任一份进入答题。
