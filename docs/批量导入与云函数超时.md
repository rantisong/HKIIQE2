# 批量导入与云函数超时

## 批量导入超时（3 秒）

若批量导入多份试卷时出现 **「Invoking task timed out after 3 seconds」**，是因为云函数默认执行超时时间为 3 秒，多文件下载与写入会超过该时间。

### 解决方式

**将云函数超时时间调大（建议 60 秒）：**

1. 微信开发者工具 → **云开发** → **云函数**。
2. 找到 **paper_importFromJson**，点击进入。
3. 在 **配置** 或 **函数配置** 中，将 **超时时间** 改为 **60 秒**（或 20～60 秒），保存并重新部署。

若使用命令行或 API 部署，请确保上传时带上 `config.json`（本项目已在 `cloudfunctions/paper_importFromJson/config.json` 中配置 `timeout: 60`），或通过云开发控制台为该函数单独设置超时时间。

## 批量导入说明

- 单次最多支持 **20** 个文件（`fileIds` 或 `contents` 长度 ≤ 20），超过会提示分批导入。
- 多个 **fileIds** 会**并行下载**，再顺序写入数据库，以减少总耗时。
- 建议单次批量 5～20 份，超时设为 60 秒即可稳定完成。
